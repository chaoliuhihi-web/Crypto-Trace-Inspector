# 开源项目整合加速方案 — 快速打造顶级产品实操指南

> **目标**：基于已发现的 **25+ 个开源项目/库**，按"能直接用 > 可借鉴移植 > 需自研"三级分类，给出从 `go get` 到代码整合的完整路径，让 crypto-inspector 在最短时间内补齐所有关键差距。

---

## 一、整合加速全景图

```
┌────────────────────────────────────────────────────────────────────────────────┐
│                       crypto-inspector 差距补齐方式                             │
├──────────────┬────────────────────────┬────────────────────────────────────────┤
│  整合方式     │  效率                  │  项目数量                              │
│              │                        │                                        │
│  🟢 直接引入  │  go get 即用           │  8 个 Go 库 + 3 个 JS 库              │
│  🟡 移植改造  │  参考源码，Go 重写      │  5 个项目                              │
│  🔵 API 接入  │  HTTP 调用即可         │  6 个免费 API                          │
│  🔴 需自研    │  无可用开源            │  3 项功能                              │
└──────────────┴────────────────────────┴────────────────────────────────────────┘
```

---

## 二、按差距域逐一对应整合方案

### 差距 1：浏览器深度取证（Cookie / 下载 / 搜索词 / 书签）

> **当前状态**：仅有浏览历史 + 扩展检测
> **目标状态**：全面覆盖 Cookie 登录态、下载记录、搜索关键词、书签、自动填充

#### 🟢 可直接引入的 Go 库

| 开源项目 | GitHub 地址 | 星数 | 能力 | 整合方式 |
|----------|-------------|------|------|----------|
| **teocci/go-chrome-cookies** | github.com/ArcticDev78/go-chrome-cookies | ★600+ | 解密 Chrome/Edge/Firefox 的 Cookie、密码、书签、历史、下载、信用卡、自动填充 | `go get` 引入，支持 Win/Mac/Linux |
| **browserutils/kooky** | github.com/browserutils/kooky | ★200+ | 跨浏览器 Cookie 读取（Chrome/Firefox/Safari/Edge），返回标准 `http.CookieJar` | `go get` 引入，过滤交易所域名 |
| **nicehash/go-chromecookies** | go.dev/pkg | — | Chrome Cookie 解密 | 备选方案 |

#### 💡 具体整合路径

```go
// 新增文件: internal/adapters/host/browser_deep.go

import (
    "github.com/ArcticDev78/go-chrome-cookies/browser"
    "github.com/browserutils/kooky"
)

// 1. Cookie 分析 — 检测交易所登录态
func (s *Scanner) scanBrowserCookies(caseID, deviceID string) (model.Artifact, error) {
    // 使用 go-chrome-cookies 解密所有浏览器 Cookie
    cookies, err := browser.DecryptAll()
    // 过滤匹配交易所域名：binance.com, okx.com, coinbase.com 等
    exchangeHits := filterByExchangeDomains(cookies, s.exchangeRules)
    return s.makeArtifact(caseID, deviceID, model.ArtifactBrowserCookie, ...)
}

// 2. 下载记录分析 — 检测钱包安装包下载
func (s *Scanner) scanBrowserDownloads(caseID, deviceID string) (model.Artifact, error) {
    downloads, _ := browser.GetDownloadHistory()
    // 匹配：MetaMask.crx, Ledger-Live-*.dmg, Trezor-Suite-*.exe 等
    walletDownloads := matchWalletDownloadPatterns(downloads)
    return s.makeArtifact(...)
}

// 3. 搜索引擎查询提取
func (s *Scanner) scanBrowserSearches(caseID, deviceID string) (model.Artifact, error) {
    history, _ := browser.GetHistory()
    searches := extractSearchQueries(history) // 从 google.com/search?q= 提取
    cryptoSearches := filterCryptoKeywords(searches) // 过滤 "bitcoin" "ETH" "钱包" "挖矿"
    return s.makeArtifact(...)
}

// 4. 书签分析
func (s *Scanner) scanBrowserBookmarks(caseID, deviceID string) (model.Artifact, error) {
    bookmarks, _ := browser.GetBookmarks()
    exchangeBookmarks := filterByExchangeDomains(bookmarks, s.exchangeRules)
    return s.makeArtifact(...)
}
```

**预计工作量**：3 天（库已成熟，主要是过滤逻辑和 Artifact 封装）

---

### 差距 2：链上交易追溯与图谱可视化

> **当前状态**：仅有 ETH/ERC20/BTC 余额查询
> **目标状态**：交易历史查询 + 资金流可视化 + 多链覆盖

#### 🔵 可直接接入的免费 API

| API 数据源 | 免费额度 | 覆盖链 | 数据类型 |
|-----------|----------|--------|----------|
| **Etherscan API** | 5 req/sec 免费 | ETH + ERC20 | 交易列表、内部交易、代币转账 |
| **Blockstream API** | 无限（已在用） | BTC | 交易详情、UTXO |
| **Tronscan API** | 免费 | TRX + TRC20 | 交易列表、合约调用 |
| **Solscan API** | 免费 | SOL + SPL | 交易历史 |
| **BscScan API** | 5 req/sec 免费 | BSC + BEP20 | 同 Etherscan |
| **Polygonscan API** | 5 req/sec 免费 | Polygon | 同 Etherscan |

#### 🟢 可直接引入的前端可视化库

| 库 | 地址 | 用途 | 整合方式 |
|----|------|------|----------|
| **Cytoscape.js** | github.com/cytoscape/cytoscape.js | 交互式交易图谱，节点/边/布局/缩放/导出 | CDN 引入或 npm install |
| **D3.js** | github.com/d3/d3 | 时间线视图、统计图表 | CDN 引入 |
| **dagre** | github.com/dagrejs/dagre | 有向无环图布局算法（交易流向专用） | 配合 Cytoscape 使用 |

#### 🟡 可参考的开源项目

| 项目 | GitHub | 语言 | 参考价值 |
|------|--------|------|----------|
| **ZetaFlow** | github.com/Shreyassp002/zetaflow | JS | 跨链交易可视化的 UI 设计和交互模式 |
| **bitcoin-tx-graph-visualizer** | github.com/weilu/bitcoin-tx-graph-visualizer | JS + D3 | BTC 交易图谱的 D3 实现参考 |
| **TrackingCarbon** | github.com/peculab/TrackingCarbon | Python + Cytoscape | 多层 ETH 交易可视化的数据模型 |

#### 💡 具体整合路径

```go
// 新增文件: internal/services/chainquery/service.go

// 交易历史查询（新增服务模块）
type TxRecord struct {
    Hash      string  `json:"hash"`
    From      string  `json:"from"`
    To        string  `json:"to"`
    Value     string  `json:"value"`
    Timestamp int64   `json:"timestamp"`
    Chain     string  `json:"chain"`
}

// 接入 Etherscan API
func (s *Service) GetETHTxList(ctx context.Context, addr string) ([]TxRecord, error) {
    url := fmt.Sprintf("https://api.etherscan.io/api?module=account&action=txlist&address=%s&sort=desc&apikey=%s", addr, s.etherscanKey)
    // ... HTTP GET → 解析 JSON → 返回 TxRecord 列表
}
```

```javascript
// 新增文件: ui/assets/graph.js — 交易图谱可视化

// 使用 Cytoscape.js 渲染交易流
const cy = cytoscape({
    container: document.getElementById('tx-graph'),
    elements: [], // 从 /api/chain/tx-graph?address=xxx 获取
    style: [
        { selector: 'node', style: { 'label': 'data(label)', 'background-color': '#6366f1' }},
        { selector: 'edge', style: { 'label': 'data(value)', 'curve-style': 'bezier' }}
    ],
    layout: { name: 'dagre' } // 有向图布局
});

// 点击地址节点 → 展开下一级交易
cy.on('tap', 'node', async (evt) => {
    const addr = evt.target.data('id');
    const txs = await fetch(`/api/chain/eth/txlist?address=${addr}`).then(r => r.json());
    // 动态添加节点和边
});
```

**附需新增的后端 API 端点**：

| 端点 | 方法 | 说明 |
|------|------|------|
| `/api/chain/eth/txlist` | GET | ETH 交易历史 |
| `/api/chain/btc/txlist` | GET | BTC 交易历史 |
| `/api/chain/trx/txlist` | GET | TRX 交易历史 |
| `/api/chain/tx-graph` | GET | 返回 Cytoscape 格式的图谱数据 |

**预计工作量**：5 天后端 + 5 天前端

---

### 差距 3：地址风险评估与情报

> **当前状态**：零能力
> **目标状态**：命中地址自动风险评分 + 黑名单/制裁标签

#### 🔵 可直接接入的免费 API（无需注册）

| API | 地址 | 免费 | 覆盖链 | 返回内容 |
|-----|------|------|--------|----------|
| **Chainabuse Public API** | chainabuse.com/api | ✅ 永久免费 | 多链 | 举报数量、骗局类型、置信度分数、损失金额 |
| **FailSafe Radar** | getfailsafe.com | ✅ 免费 | 多链 | 即时风险评分（0-100），多源情报汇总 |
| **Scorechain Sanctions** | scorechain.com | ✅ 免费 | 14 链 | OFAC/EU/UN 制裁名单比对 |
| **AMLBot Free** | amlbot.com | ✅ 免费 | 多链 | 风险百分比、风险来源分类 |

#### 🟢 可直接引入的开源风险评估项目

| 项目 | GitHub | 语言 | 说明 |
|------|--------|------|------|
| **Januus/cryptowallet_risk_scoring** | github.com/Januus | Python | 开源钱包风险评分：ETH/BTC/TRX，检测与威胁行为者的关联，输出 JSON 报告 |

#### 💡 具体整合路径

```go
// 新增文件: internal/adapters/intel/chainabuse.go

const ChainabuseAPI = "https://www.chainabuse.com/api/v1/check"

type RiskReport struct {
    Address       string `json:"address"`
    Chain         string `json:"chain"`
    ReportCount   int    `json:"report_count"`
    RiskScore     int    `json:"risk_score"`     // 0-100
    Categories    []string `json:"categories"`   // "scam", "ransomware", "darknet", "mixer"
    IsSanctioned  bool   `json:"is_sanctioned"`
    Sources       []string `json:"sources"`       // "Chainabuse", "FailSafe", "Scorechain"
}

// CheckAddressRisk 聚合多个免费 API 的结果
func (p *IntelProvider) CheckAddressRisk(ctx context.Context, chain, address string) (*RiskReport, error) {
    report := &RiskReport{Address: address, Chain: chain}
    
    // 1. Chainabuse 查询
    cab := queryChainabuse(ctx, address)
    report.ReportCount = cab.TotalReports
    report.Categories = cab.Categories
    
    // 2. Scorechain 制裁检查
    sanc := queryScorechain(ctx, chain, address)
    report.IsSanctioned = sanc.IsSanctioned
    
    // 3. 综合风险评分
    report.RiskScore = calculateRiskScore(report)
    return report, nil
}
```

**前端展示**：命中结果卡片上增加"风险评分"徽章：🟢 低风险 / 🟡 中风险 / 🔴 高风险 / ⚫ 制裁名单

**预计工作量**：3 天（API 对接 + 评分逻辑 + 前端徽章）

---

### 差距 4：加密货币地址正则全文提取

> **当前状态**：仅匹配浏览器扩展 ID 和域名
> **目标状态**：从任意文本中提取 BTC/ETH/TRX/SOL 等地址，并自动查询余额和风险

#### 🟢 可直接引入的 Go 库

| Go 库 | go get 路径 | 用途 |
|-------|-------------|------|
| **go-ethereum** | `github.com/ethereum/go-ethereum/common` | `common.IsHexAddress()` 验证 ETH 地址 |
| **btcsuite/btcd** | `github.com/btcsuite/btcd` | BTC 地址解码和校验 |
| **gagliardetto/solana-go** | `github.com/gagliardetto/solana-go` | SOL 地址验证 |
| **getbitpocket/crypto-regex** | github.com/getbitpocket/crypto-regex | 多链地址正则集合（参考） |

#### 💡 具体整合路径

```go
// 新增文件: internal/adapters/address/scanner.go

import "regexp"

// 多链地址正则 — 参考 getbitpocket/crypto-regex + awesome OSINT 列表
var addressPatterns = map[string]*regexp.Regexp{
    "BTC_Legacy":  regexp.MustCompile(`[13][a-km-zA-HJ-NP-Z1-9]{25,34}`),
    "BTC_Bech32":  regexp.MustCompile(`bc1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{39,59}`),
    "BTC_Taproot": regexp.MustCompile(`bc1p[a-zA-Z0-9]{38,58}`),
    "ETH":         regexp.MustCompile(`0x[a-fA-F0-9]{40}`),
    "TRX":         regexp.MustCompile(`T[A-Za-z1-9]{33}`),
    "SOL":         regexp.MustCompile(`[1-9A-HJ-NP-Za-km-z]{32,44}`),
    "XMR":         regexp.MustCompile(`4[0-9AB][0-9a-zA-Z]{93}`),
}

// ScanTextForAddresses 从任意文本中提取所有加密地址
func ScanTextForAddresses(text string) []DetectedAddress {
    var results []DetectedAddress
    for chain, pattern := range addressPatterns {
        matches := pattern.FindAllString(text, -1)
        for _, m := range matches {
            if validateAddress(chain, m) { // 校验码验证
                results = append(results, DetectedAddress{Chain: chain, Address: m})
            }
        }
    }
    return results
}
```

**应用场景**：
- 扫描浏览器历史 URL 中出现的地址
- 扫描剪贴板历史（macOS `pbpaste`）
- 扫描下载文件内容中的地址
- 扫描备忘录/文本文件中的地址

**预计工作量**：2 天

---

### 差距 5：USB / 硬件钱包连接检测

> **当前状态**：零能力
> **目标状态**：检测 Ledger/Trezor/KeepKey 等硬件钱包的 USB 连接历史

#### 🟢 可用的 Go 库

| Go 库 | 用途 | 平台 |
|-------|------|------|
| `golang.org/x/sys/windows/registry` | 读取 Windows 注册表 USBSTOR 键 | Windows |
| `github.com/deepakjois/gousbdrivedetector` | 检测当前 USB 存储设备 | Win/Mac/Linux |
| `github.com/rafaelmartins/usbhid` | USB HID 设备接口（硬件钱包通信协议） | Win/Mac/Linux |

#### 💡 具体整合路径

```go
// 新增文件: internal/adapters/host/usb_scanner.go

// 已知硬件钱包 USB Vendor ID（HID 协议）
var knownWalletVendors = map[string]string{
    "2c97": "Ledger",
    "534c": "Trezor (SatoshiLabs)",
    "2b24": "KeepKey",
    "1209": "Generic Crypto HW",
}

// ScanUSBHistory_macOS 从 Unified Log 中提取 USB 设备连接记录
func ScanUSBHistory_macOS() ([]USBDevice, error) {
    // macOS: log show --predicate 'subsystem == "com.apple.usbd"' --last 30d
    cmd := exec.Command("log", "show",
        "--predicate", `subsystem == "com.apple.usbd"`,
        "--last", "30d",
        "--style", "ndjson")
    output, _ := cmd.Output()
    return parseUSBLogEntries(output, knownWalletVendors)
}

// ScanUSBHistory_Windows 从注册表中读取 USBSTOR
func ScanUSBHistory_Windows() ([]USBDevice, error) {
    // HKLM\SYSTEM\CurrentControlSet\Enum\USB — 遍历所有子键
    // 匹配 VID_2C97 (Ledger) / VID_534C (Trezor) / VID_2B24 (KeepKey)
    key, _ := registry.OpenKey(registry.LOCAL_MACHINE,
        `SYSTEM\CurrentControlSet\Enum\USB`, registry.ENUMERATE_SUB_KEYS)
    // ...
}
```

**预计工作量**：3 天（macOS 2 天 + Windows 1 天）

---

### 差距 6：内存取证 / YARA 扫描

> **当前状态**：零能力
> **目标状态**：支持加载内存转储，YARA 扫描钱包痕迹

#### 🟢 可直接引入的 Go 库

| Go 库 | go get 路径 | 说明 |
|-------|-------------|------|
| **go-yara** | `github.com/hillu/go-yara/v4` | YARA 官方 Go 绑定，支持 `ScanFile()`/`ScanMem()` |

#### 🟡 可参考的 YARA 规则集

| 项目 | GitHub | 内容 |
|------|--------|------|
| **Yara-Rules/rules** | github.com/Yara-Rules/rules | `/crypto/` 目录：加密算法签名 |
| **FORESHADOW** | github.com/BiTLab-BaggiliTruthLab/FORESHADOW | Ledger Live / Trezor Wallet 内存特征签名（参考移植） |
| **ReversingLabs YARA** | github.com/reversinglabs/reversinglabs-yara-rules | 100+ 恶意软件规则（可检测加密劫持）|

#### 💡 具体整合路径

```go
// 新增文件: internal/adapters/memory/scanner.go

import yara "github.com/hillu/go-yara/v4"

// 加载 YARA 规则
func NewMemoryScanner(rulesDir string) (*MemoryScanner, error) {
    compiler, _ := yara.NewCompiler()
    // 加载自定义钱包签名规则
    compiler.AddFile("rules/ledger_live.yar", "ledger")
    compiler.AddFile("rules/trezor_suite.yar", "trezor")
    compiler.AddFile("rules/metamask.yar", "metamask")
    compiler.AddFile("rules/crypto_addresses.yar", "addresses")
    rules, _ := compiler.GetRules()
    return &MemoryScanner{rules: rules}, nil
}

// 扫描内存转储文件
func (s *MemoryScanner) ScanDumpFile(path string) ([]MemoryHit, error) {
    matches, _ := s.rules.ScanFile(path, 0, 300) // 300 秒超时
    var hits []MemoryHit
    for _, match := range matches {
        hits = append(hits, MemoryHit{
            Rule:     match.Rule,
            Strings:  extractMatchStrings(match),
            Category: match.Tags,
        })
    }
    return hits, nil
}
```

```yara
// 新增文件: data/rules/yara/ledger_live.yar
// 参考 FORESHADOW 论文中的签名模式

rule LedgerLive_Memory {
    meta:
        description = "Detects Ledger Live client data in memory"
        author = "crypto-inspector"
        reference = "FORESHADOW (Thomas et al. 2020)"
    strings:
        $api_endpoint = "https://explorers.api.live.ledger.com" ascii
        $xpub_prefix = "xpub" ascii
        $device_id = "Nano" ascii
        $app_name = "Ledger Live" ascii wide
        $btc_derivation = "m/84'/0'/0'" ascii
        $eth_derivation = "m/44'/60'/0'" ascii
    condition:
        any of them
}

rule TrezorSuite_Memory {
    meta:
        description = "Detects Trezor Suite client data in memory"
    strings:
        $api = "https://data.trezor.io" ascii
        $device = "Trezor" ascii wide
        $xpub_key = "xpub" ascii
        $model_t = "T2T1" ascii
        $model_one = "T1B1" ascii
    condition:
        any of them
}

rule CryptoAddress_Memory {
    meta:
        description = "Detects cryptocurrency addresses in memory/files"
    strings:
        $btc_legacy = /[13][a-km-zA-HJ-NP-Z1-9]{25,34}/
        $btc_bech32 = /bc1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{39,59}/
        $eth_addr = /0x[a-fA-F0-9]{40}/
        $trx_addr = /T[A-Za-z1-9]{33}/
    condition:
        any of them
}
```

**预计工作量**：5 天（go-yara 集成 2 天 + YARA 规则编写 2 天 + 流程编排 1 天）

---

### 差距 7：已删除数据恢复（SQLite WAL）

> **当前状态**：零能力
> **目标状态**：从浏览器 WAL 文件中恢复已删除的浏览历史

#### 🟡 可参考的开源项目

| 项目 | GitHub | 语言 | 说明 |
|------|--------|------|------|
| **pawlaszczyk/fqlite** | github.com/pawlaszczyk/fqlite | Java | SQLite 取证工具包：恢复已删除记录、WAL 解析、CSV 导出 |
| **ranlor/WAL-parser-sqlite** | github.com/ranlor/WAL-parser-sqlite | C++ | WAL 二进制解析器，输出 CSV/SQL |
| **mdegrazia/SQLite-Deleted-Records-Parser** | github.com/mdegrazia/SQLite-Deleted-Records-Parser | Python | 从 SQLite 数据库中恢复已删除条目 |

#### 💡 具体整合路径

SQLite WAL 文件格式是公开文档化的。核心思路：

```go
// 新增文件: internal/adapters/host/wal_recovery.go

// WAL 文件头格式（定长 32 字节）
type WALHeader struct {
    Magic          uint32 // 0x377f0682 或 0x377f0683
    FormatVersion  uint32
    PageSize       uint32
    CheckpointSeq  uint32
    Salt1          uint32
    Salt2          uint32
    Checksum1      uint32
    Checksum2      uint32
}

// WAL 帧头（每帧 24 字节）
type WALFrameHeader struct {
    PageNumber uint32
    Pages      uint32 // 对于 commit 帧，为数据库总页数
    Salt1      uint32
    Salt2      uint32
    Checksum1  uint32
    Checksum2  uint32
}

// RecoverDeletedHistory 从浏览器 WAL 文件中恢复已删除记录
func RecoverDeletedHistory(walPath string) ([]RecoveredRecord, error) {
    // 1. 解析 WAL 头
    // 2. 遍历所有帧，提取页面数据
    // 3. 在页面中搜索 SQLite B-tree 叶页的空闲空间
    // 4. 从空闲空间中 carving 出已删除的行记录
    // 5. 解码为 URL/标题/时间戳等字段
}
```

**预计工作量**：5 天（WAL 格式解析复杂，建议先实现基础版）

---

### 差距 8：钱包数据目录深度扫描

> **当前状态**：仅检测应用安装和浏览器扩展
> **目标状态**：扫描所有已知钱包的数据目录

#### 🟢 可直接实现（无需外部库）

```go
// 新增文件: internal/adapters/host/wallet_dirs.go

// 已知钱包数据目录路径（跨平台）
var walletDataDirs = []WalletDirSignature{
    // 桌面钱包
    {Name: "Bitcoin Core", Paths: []string{
        "~/.bitcoin/",                                    // Linux
        "~/Library/Application Support/Bitcoin/",          // macOS
        "%APPDATA%\\Bitcoin\\",                           // Windows
    }, KeyFiles: []string{"wallet.dat", "wallets/"}},
    
    {Name: "Ethereum (Geth)", Paths: []string{
        "~/.ethereum/",
        "~/Library/Ethereum/",
        "%APPDATA%\\Ethereum\\",
    }, KeyFiles: []string{"keystore/", "geth/chaindata/"}},
    
    {Name: "Ledger Live", Paths: []string{
        "~/Library/Application Support/Ledger Live/",
        "%APPDATA%\\Ledger Live\\",
    }, KeyFiles: []string{"app.json", "accounts/"}},
    
    {Name: "Trezor Suite", Paths: []string{
        "~/Library/Application Support/@trezor/suite-desktop/",
        "%APPDATA%\\@trezor\\suite-desktop\\",
    }, KeyFiles: []string{"IndexedDB/", "Local Storage/"}},
    
    {Name: "Exodus", Paths: []string{
        "~/Library/Application Support/Exodus/",
        "%APPDATA%\\Exodus\\",
    }, KeyFiles: []string{"exodus.wallet/", "exodus.conf.json"}},
    
    {Name: "Electrum", Paths: []string{
        "~/.electrum/",
        "~/Library/Application Support/Electrum/",
        "%APPDATA%\\Electrum\\",
    }, KeyFiles: []string{"wallets/", "config"}},
    
    {Name: "Atomic Wallet", Paths: []string{
        "~/Library/Application Support/atomic/",
        "%APPDATA%\\atomic\\",
    }, KeyFiles: []string{"Local Storage/"}},
    
    {Name: "Trust Wallet (Desktop)", Paths: []string{
        "~/Library/Application Support/Trust Wallet/",
    }, KeyFiles: []string{}},
    
    // 移动端备份可能出现的路径
    {Name: "MetaMask Mobile (Backup)", Paths: []string{
        "~/Library/Application Support/Google/Chrome/Default/IndexedDB/chrome-extension_nkbihfbeogaeaoehlefnkodbefgpgknn*/",
    }, KeyFiles: []string{}},
}

// ScanWalletDirectories 检测存在的钱包数据目录
func ScanWalletDirectories() ([]WalletDirHit, error) {
    // 遍历每个签名，展开路径，检测文件存在性
    // 对发现的目录：计算大小、最后修改时间、关键文件列表
}
```

**预计工作量**：2 天

---

### 差距 9：专业级 Web UI

> **当前状态**：基础暗色单页应用
> **目标状态**：专业级数据分析界面，对标 Chainalysis Reactor

#### 🟢 可直接引入的前端框架/库

| 库 | 用途 | 引入方式 |
|----|------|----------|
| **Chart.js** | 统计图表（饼图/柱图/折线图） | CDN |
| **Cytoscape.js** | 交易图谱 | CDN |
| **Flatpickr** | 日期选择器 | CDN |
| **DataTables / AG Grid** | 专业数据表格（排序/筛选/分页） | CDN |
| **SweetAlert2** | 美观的弹窗/通知 | CDN |
| **Animate.css** | 微动画 | CDN |

#### 需要新增的页面/组件

| 页面 | 描述 | 数据来源 |
|------|------|----------|
| **Dashboard 仪表盘** | 案件统计、命中分布图、最近活动 | `/api/meta` + `/api/cases` |
| **地址风险画像** | 余额/交易数/风险分/标签/交易图 | `/api/chain/*` + `/api/intel/*` |
| **时间线视图** | 所有证据的时间轴展示 | `/api/cases/{id}/artifacts` |
| **交易图谱** | 交互式资金流可视化 | `/api/chain/tx-graph` |
| **对比分析** | 多个案件/设备的对比视图 | 多个 API |

**预计工作量**：10 天（全面 UI 重构）

---

## 三、整合优先级排序（投入产出比排名）

| 排名 | 整合项 | 工作量 | 效果 | 整合方式 | 核心依赖 |
|------|--------|--------|------|----------|----------|
| **1** | 浏览器深度取证 | 3 天 | ⭐⭐⭐⭐⭐ | go get | `go-chrome-cookies` + `kooky` |
| **2** | 地址风险评估 | 3 天 | ⭐⭐⭐⭐⭐ | API 调用 | Chainabuse + FailSafe |
| **3** | 地址正则提取 | 2 天 | ⭐⭐⭐⭐ | 自研 + go get | `go-ethereum` + `btcsuite` |
| **4** | 钱包目录扫描 | 2 天 | ⭐⭐⭐⭐ | 自研 | 路径列表 |
| **5** | 链上交易追溯 | 5 天 | ⭐⭐⭐⭐⭐ | API 调用 | Etherscan/Blockstream |
| **6** | USB 硬件钱包检测 | 3 天 | ⭐⭐⭐⭐ | 自研 | 系统日志/注册表 |
| **7** | 交易图谱可视化 | 5 天 | ⭐⭐⭐⭐⭐ | CDN 引入 | Cytoscape.js + dagre |
| **8** | 仪表盘/UI 重构 | 10 天 | ⭐⭐⭐⭐⭐ | 前端重构 | Chart.js + DataTables |
| **9** | YARA 内存取证 | 5 天 | ⭐⭐⭐⭐ | go get + 规则 | `go-yara` + FORESHADOW |
| **10** | WAL 删除恢复 | 5 天 | ⭐⭐⭐ | 自研 | SQLite 格式规范 |

---

## 四、快速启动行动计划

### 第 1 周：立即见效的 3 个整合（10 天 → 5 天并行）

```bash
# Day 1: 引入浏览器取证库
go get github.com/ArcticDev78/go-chrome-cookies@latest
go get github.com/browserutils/kooky@latest

# Day 1-3: 实现浏览器深度扫描模块
# → Cookie 分析、下载记录、搜索词提取、书签分析

# Day 2-4: 接入风险评估 API
# → Chainabuse + FailSafe + Scorechain，风险评分引擎

# Day 3-5: 地址正则提取模块
go get github.com/ethereum/go-ethereum@latest
# → 多链地址正则 + 校验 + 自动余额查询 + 风险标签
```

### 第 2 周：核心可视化（5 天）

```html
<!-- Day 6: 引入前端库 -->
<script src="https://unpkg.com/cytoscape@3/dist/cytoscape.min.js"></script>
<script src="https://unpkg.com/dagre@0.8/dist/dagre.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
```

```bash
# Day 6-8: 链上交易追溯后端
# → Etherscan/Blockstream/Tronscan API 对接

# Day 8-10: 交易图谱前端
# → Cytoscape.js 交互式图谱 + Dashboard 仪表盘
```

### 第 3 周：硬件级取证（5 天）

```bash
# Day 11-13: USB 设备历史 + 钱包目录扫描
# Day 14-15: YARA 规则 + go-yara 集成
go get github.com/hillu/go-yara/v4@latest
```

> [!IMPORTANT]
> **3 周（15 个工作日）完成以上所有整合后，crypto-inspector 将从"检测工具"蜕变为"一站式调查平台"——覆盖设备取证、链上追溯、风险定性三大核心能力域。**

---

## 五、开源项目完整清单

### Go 库（直接 `go get`）

| 序号 | 库 | 用途 | 许可证 |
|------|-----|------|--------|
| 1 | `go-chrome-cookies` | 浏览器数据解密 | MIT |
| 2 | `browserutils/kooky` | 跨浏览器 Cookie | MIT |
| 3 | `hillu/go-yara/v4` | YARA 规则扫描 | BSD-2 |
| 4 | `ethereum/go-ethereum` | ETH 地址验证 | LGPL-3 |
| 5 | `btcsuite/btcd` | BTC 地址验证 | ISC |
| 6 | `gagliardetto/solana-go` | SOL 地址验证 | Apache-2 |
| 7 | `rafaelmartins/usbhid` | USB HID 设备 | MIT |
| 8 | `deepakjois/gousbdrivedetector` | USB 检测 | MIT |

### JavaScript 库（CDN 引入）

| 序号 | 库 | 用途 |
|------|-----|------|
| 1 | Cytoscape.js | 交易图谱可视化 |
| 2 | D3.js | 时间线/统计图表 |
| 3 | Chart.js | Dashboard 图表 |
| 4 | dagre | 有向图布局 |
| 5 | DataTables | 专业数据表格 |

### 免费 API

| 序号 | API | 用途 | 限制 |
|------|-----|------|------|
| 1 | Chainabuse | 恶意地址查询 | 无限免费 |
| 2 | FailSafe Radar | 风险评分 | 免费 |
| 3 | Scorechain | 制裁名单 | 免费 |
| 4 | Etherscan | ETH 交易查询 | 5 req/s |
| 5 | Blockstream | BTC 交易查询 | 无限 |
| 6 | Tronscan | TRX 交易查询 | 免费 |

### 参考项目（移植/借鉴）

| 序号 | 项目 | 借鉴内容 |
|------|------|----------|
| 1 | FORESHADOW | 硬件钱包 YARA 签名 + 内存数据结构 |
| 2 | fqlite | SQLite WAL 恢复算法 |
| 3 | Januus risk scoring | 风险评分权重模型 |
| 4 | ZetaFlow | 交易图谱 UI 设计 |
| 5 | forensix | Chrome 取证数据模型 |
